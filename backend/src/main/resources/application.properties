# Davon Library System Configuration

# Database configuration - MSSQL datasource
quarkus.datasource.db-kind=mssql
quarkus.datasource.username=sa
quarkus.datasource.password=LibraryDB123!
quarkus.datasource.jdbc.url=jdbc:sqlserver://localhost:1433;databaseName=LibraryManagementSystem;encrypt=true;trustServerCertificate=true

# Connection pool configuration for JDBC (Agroal)
quarkus.datasource.jdbc.max-size=20
quarkus.datasource.jdbc.idle-removal-interval=PT10M
quarkus.datasource.jdbc.max-lifetime=PT1H
quarkus.datasource.jdbc.validation-query-sql=SELECT 1

# Enable Hibernate ORM for MSSQL
quarkus.hibernate-orm.active=true
# This will drop and re-create the database schema on every startup.
# Be cautious with this setting in a production environment.
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true

# MSSQL specific Hibernate configuration
quarkus.hibernate-orm.dialect=org.hibernate.dialect.SQLServer2012Dialect
quarkus.hibernate-orm.physical-naming-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# HTTP configuration - Default port
quarkus.http.port=8080
quarkus.http.host=0.0.0.0

# Completely disable all security features
quarkus.security.csrf.enable=false
quarkus.security.auth.enabled-in-dev-mode=false
quarkus.security.identity.enabled=false
quarkus.security.deny-unannotated-endpoints=false
quarkus.security.events.enabled=false
quarkus.security.permission.deny-by-default=false
quarkus.security.csrf.token-enabled=false
quarkus.security.csrf.cookie-enabled=false

# Disable REST CSRF filter completely
quarkus.rest-csrf.enable=false
quarkus.rest-csrf.token-enabled=false
quarkus.rest-csrf.cookie-enabled=false
quarkus.rest-csrf.exclude-paths=/api/*

# CORS configuration for frontend
quarkus.http.cors=true
quarkus.http.cors.origins=http://localhost:3001
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=Content-Disposition
quarkus.http.cors.access-control-max-age=24H

# Application configuration
quarkus.application.name=Davon Library System
quarkus.application.version=1.0.0-SNAPSHOT

# Jackson configuration for JSON
quarkus.jackson.property-naming-strategy=LOWER_CAMEL_CASE
quarkus.jackson.serialization-inclusion=non-null

# Validation configuration
quarkus.hibernate-validator.fail-fast=false

# Swagger/OpenAPI configuration
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/swagger-ui
quarkus.smallrye-openapi.path=/openapi

# Disable interactive console as per user guide to prevent terminal issues
quarkus.console=false

# Development mode logging
%dev.quarkus.log.level=INFO
%dev.quarkus.log.category."com.davonlibrary".level=DEBUG

# Debug configuration for development
%dev.quarkus.debug.reflection=true
%dev.quarkus.debug.generated-classes-dir=target/generated-classes
%dev.quarkus.debug.print-startup-times=true

# Remote debugging configuration
%dev.java.arg.debug=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005

# Memory and GC settings to prevent reference processing issues
%dev.java.arg.memory=-Xms512m -Xmx1024m
%dev.java.arg.gc=-XX:+UseG1GC -XX:MaxGCPauseMillis=200
%dev.java.arg.debug.gc=-XX:+PrintGCDetails -XX:+PrintGCTimeStamps

# Disable reference processing debugging to prevent hangs
%dev.java.arg.ref=-XX:+DisableExplicitGC -XX:+UseConcMarkSweepGC

# =====================================================
# MSSQL PRODUCTION CONFIGURATION
# =====================================================

# MSSQL Database configuration
%prod.quarkus.datasource.db-kind=mssql
%prod.quarkus.datasource.username=sa
%prod.quarkus.datasource.password=LibraryDB123!
%prod.quarkus.datasource.jdbc.url=jdbc:sqlserver://localhost:1433;databaseName=LibraryManagementSystem;encrypt=true;trustServerCertificate=true

# Enable Hibernate ORM for production
%prod.quarkus.hibernate-orm.active=true
%prod.quarkus.hibernate-orm.database.generation=none
%prod.quarkus.hibernate-orm.log.sql=false

# MSSQL Development configuration (for testing with MSSQL)
%mssql.quarkus.datasource.db-kind=mssql
%mssql.quarkus.datasource.username=sa
%mssql.quarkus.datasource.password=LibraryDB123!
%mssql.quarkus.datasource.jdbc.url=jdbc:sqlserver://localhost:1433;databaseName=LibraryManagementSystem;encrypt=true;trustServerCertificate=true

# Enable Hibernate ORM for MSSQL development
%mssql.quarkus.hibernate-orm.active=true
%mssql.quarkus.hibernate-orm.database.generation=none
%mssql.quarkus.hibernate-orm.log.sql=true

# MSSQL HTTP configuration (different port to avoid conflicts)
%mssql.quarkus.http.port=8081
%mssql.quarkus.http.host=0.0.0.0

# MSSQL debug configuration
%mssql.quarkus.log.level=DEBUG
%mssql.quarkus.log.category."com.davonlibrary".level=DEBUG
